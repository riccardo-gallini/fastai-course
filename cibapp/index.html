<!doctype html>
<html>

<head>
	<script
	src="https://code.jquery.com/jquery-3.3.1.min.js"
	integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
	crossorigin="anonymous"></script>

	<style>
		body{ background-color: ivory; }
		#canvas{border:1px solid red;}
	</style>

	<script>
		$(function(){
		
			var canvas=document.getElementById("canvas");
			var ctx=canvas.getContext("2d");
		
			$("#fileInput").change(function(e){
				var URL = window.URL;
				var url = URL.createObjectURL(e.target.files[0]);
				var img = new Image();
				img.onload = function() {
						canvas.width=244;
						canvas.height = 244;
						ctx.drawImage(img,0,0,244,244);
				}
				img.src = url;
			});

			$("#save").click(function(e) {predict();});
		
		}); 

	function predict() {
		var formData = new FormData();
	
		var canvas=document.getElementById("canvas");
		fileData = canvas.toDataURL('image/jpeg');
	
		formData.append('imageData', fileData);
	
		$.ajax({
			type: 'POST',
			url: '/predict',
			data: formData,
			contentType: false,
			processData: false,
			success: function (data) {
				if (data.success) {
					alert('Your file was successfully uploaded!');
				} else {
					alert('There was an error uploading your file!');
				}
			},
			error: function (data) {
				alert('There was an error uploading your file!');
			}
		});
	}

</script>
</head>
<body>
    <input type="file" id="fileInput">    
    <button id="save">Save</button><br>
    <canvas id="canvas" width=300 height=300></canvas>
</body>
</html>


